require: slotfilling/slotFilling.sc
  module = sys.zb-common
theme: /

    state: –ù–∞—á–∞–ª–æ
        q!: $regex</start>
        intent!: /—Å—ã–≥—Ä–∞—Ç—å
        intent!: /–ø—Ä–∏–≤–µ—Ç
        a: –ü—Ä–∏–≤–µ—Ç! –Ø –∑–∞–≥–∞–¥–∞–ª —Ç–∞–π–Ω–æ–µ 4-–∑–Ω–∞—á–Ω–æ–µ —á–∏—Å–ª–æ. –¶–∏—Ñ—Ä—ã –≤ —ç—Ç–æ–º —á–∏—Å–ª–µ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è. –Ø –ø–æ–¥—Å—á–∏—Ç–∞—é —Å–∫–æ–ª—å–∫–æ –±—ã–∫–æ–≤ –∏ –∫–æ—Ä–æ–≤ –≤ —Ç–≤–æ–µ–º —á–∏—Å–ª–µ. –ö–û–†–û–í–´ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≥–∞–¥–∞–Ω–Ω—ã—Ö —Ü–∏—Ñ—Ä —Ç–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–æ, –∞ –ë–´–ö–ò - —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É–≥–∞–¥–∞–Ω–Ω–∞—è —Ü–∏—Ñ—Ä–∞ —Å—Ç–æ–∏—Ç –≤ –Ω—É–∂–Ω–æ–º –º–µ—Å—Ç–µ. –•–æ—á–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å?
        go!: /–°–æ–≥–ª–∞—Å–µ–Ω
        
    state: –°–æ–≥–ª–∞—Å–µ–Ω

            state: –î–∞
                intent: /—Å–æ–≥–ª–∞—Å–∏–µ
                go!: /–ò–≥—Ä–∞

            state: –ù–µ—Ç
                intent: /–Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ
                a: –ó–∞—Ö–æ—á–µ—à—å —Å—ã–≥—Ä–∞—Ç—å - –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏.
                
    state: –ò–≥—Ä–∞
        # –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 1000 –¥–æ 10000 (–Ω–µ–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)
        script:
            $session.secret = Math.floor(Math.random() * 9000) + 1000;
            $reactions.answer("–ó–∞–≥–∞–¥–∞–Ω–æ {{$session.secret}}");
            $reactions.transition("/–ü—Ä–æ–≤–µ—Ä–∫–∞");
            
    state: –ü—Ä–æ–≤–µ—Ä–∫–∞
        intent!: /—á–∏—Å–ª–æ
        script:
            var num = $parseTree._number;
            $reactions.answer("–í–∞—à–µ —á–∏—Å–ª–æ {{$parseTree._number}}");
            $session.bulls = 0;
            $session.cows = 0;
            
            for (var i = 0; i < 4; i++) {
                if ($session.secret.toString().indexOf(num.toString()[i]) !== -1) {
                    $session.cows++;
                    }
                    if ($session.secret.toString()[i] === num.toString()[i]) {
                        $session.bulls++;
                    }
                }
            
            if ($session.bulls < 4) {
                $reactions.answer("–ë—ã–∫–æ–≤ üêÇ: {{$session.bulls}}. –ö–æ—Ä–æ–≤ üêÑ: {{$session.cows}}.\n–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑, —á—Ç–æ–±—ã —É–≥–∞–¥–∞—Ç—å —á–∏—Å–ª–æ —Ü–µ–ª–∏–∫–æ–º.");
            }
            else {
                $reactions.answer("–ë—ã–∫–æ–≤ üêÇ: {{$session.bulls}}. –ö–æ—Ä–æ–≤ üêÑ: {{$session.cows}}. –¢—ã –æ—Ç–≥–∞–¥–∞–ª(–∞) —á–∏—Å–ª–æ! –•–æ—á–µ—à—å —Å—ã–≥—Ä–∞—Ç—å –∑–∞–Ω–æ–≤–æ?");
            }
        go: /–°–æ–≥–ª–∞—Å–µ–Ω 

            
    state: NoMatch
        event!: noMatch
        a: –Ø –Ω–µ –ø–æ–Ω—è–ª. –í—ã —Å–∫–∞–∑–∞–ª–∏: {{$request.query}}